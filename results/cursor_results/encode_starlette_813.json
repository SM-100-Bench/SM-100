{
  "url": "https://github.com/encode/starlette/pull/813",
  "identifier": "encode_starlette_813",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/base.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a047,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Memory\u00a0leak\u00a0potential\u00a0in\u00a0body_stream()\u00a0-\u00a0if\u00a0the\u00a0task\u00a0fails,\u00a0the\u00a0queue\u00a0may\u00a0never\u00a0be\u00a0cleaned\u00a0up\u00a0properly\u00a0since\u00a0there's\u00a0no\u00a0error\u00a0handling\u00a0around\u00a0the\u00a0queue.get()\u00a0calls\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/gzip.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a042,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Resource\u00a0leak\u00a0-\u00a0gzip_file\u00a0and\u00a0gzip_buffer\u00a0are\u00a0not\u00a0properly\u00a0closed/cleaned\u00a0up\u00a0if\u00a0an\u00a0exception\u00a0occurs\u00a0during\u00a0streaming\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/sessions.py\",\u00a0\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a054,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability\u00a0-\u00a0session\u00a0cookie\u00a0is\u00a0not\u00a0marked\u00a0as\u00a0secure\u00a0by\u00a0default,\u00a0allowing\u00a0session\u00a0data\u00a0to\u00a0be\u00a0transmitted\u00a0over\u00a0insecure\u00a0HTTP\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/sessions.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a047,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0issue\u00a0-\u00a0no\u00a0session\u00a0data\u00a0encryption,\u00a0only\u00a0signing\u00a0is\u00a0used.\u00a0Sensitive\u00a0session\u00a0data\u00a0could\u00a0be\u00a0read\u00a0by\u00a0end\u00a0users\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/cors.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a095,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability\u00a0-\u00a0if\u00a0allow_credentials\u00a0is\u00a0True\u00a0and\u00a0allow_all_origins\u00a0is\u00a0True\u00a0('*'),\u00a0browsers\u00a0will\u00a0reject\u00a0the\u00a0CORS\u00a0headers\u00a0as\u00a0this\u00a0is\u00a0an\u00a0invalid\u00a0configuration\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/wsgi.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a017,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0memory\u00a0issue\u00a0-\u00a0loads\u00a0entire\u00a0request\u00a0body\u00a0into\u00a0memory\u00a0without\u00a0size\u00a0limits\u00a0when\u00a0building\u00a0WSGI\u00a0environ\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/wsgi.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a089,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Race\u00a0condition\u00a0potential\u00a0in\u00a0sender()\u00a0-\u00a0send_queue\u00a0modifications\u00a0are\u00a0not\u00a0thread-safe\u00a0but\u00a0accessed\u00a0from\u00a0different\u00a0contexts\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/authentication.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a031,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0issue\u00a0-\u00a0default_on_error\u00a0returns\u00a0400\u00a0Bad\u00a0Request\u00a0instead\u00a0of\u00a0401\u00a0Unauthorized\u00a0for\u00a0authentication\u00a0errors,\u00a0which\u00a0is\u00a0semantically\u00a0incorrect\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/trustedhost.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a041,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability\u00a0-\u00a0host\u00a0header\u00a0validation\u00a0splits\u00a0on\u00a0first\u00a0colon,\u00a0allowing\u00a0bypass\u00a0via\u00a0Host:\u00a0valid.com:@evil.com\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"starlette/middleware/errors.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a095,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0concern\u00a0-\u00a0debug\u00a0error\u00a0pages\u00a0show\u00a0full\u00a0tracebacks\u00a0including\u00a0local\u00a0variables\u00a0which\u00a0could\u00a0expose\u00a0sensitive\u00a0information\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-01 13:59:43"
}