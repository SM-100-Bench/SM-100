{
  "url": "https://github.com/websockets/ws/pull/2231",
  "identifier": "websockets_ws_2231",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0288,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Race\u00a0condition\u00a0in\u00a0close()\u00a0method\u00a0-\u00a0if\u00a0close()\u00a0is\u00a0called\u00a0multiple\u00a0times\u00a0rapidly,\u00a0the\u00a0socket\u00a0may\u00a0be\u00a0destroyed\u00a0before\u00a0the\u00a0close\u00a0frame\u00a0is\u00a0sent\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0447,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0memory\u00a0leak\u00a0in\u00a0send()\u00a0method\u00a0-\u00a0if\u00a0data\u00a0is\u00a0sent\u00a0after\u00a0close()\u00a0is\u00a0called,\u00a0it's\u00a0added\u00a0to\u00a0_bufferedAmount\u00a0but\u00a0never\u00a0cleared\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01250,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Socket\u00a0close\u00a0handler\u00a0may\u00a0miss\u00a0buffered\u00a0data\u00a0-\u00a0if\u00a0socket\u00a0is\u00a0destroyed\u00a0while\u00a0paused,\u00a0buffered\u00a0data\u00a0may\u00a0be\u00a0lost\u00a0without\u00a0proper\u00a0cleanup\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01075,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0error\u00a0handling\u00a0in\u00a0abortHandshake()\u00a0-\u00a0if\u00a0stream.socket\u00a0is\u00a0undefined,\u00a0the\u00a0error\u00a0may\u00a0not\u00a0be\u00a0properly\u00a0propagated\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0653,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability\u00a0in\u00a0initAsClient()\u00a0-\u00a0Basic\u00a0auth\u00a0credentials\u00a0are\u00a0sent\u00a0in\u00a0plain\u00a0text\u00a0in\u00a0headers\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01141,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0denial\u00a0of\u00a0service\u00a0in\u00a0receiverOnConclude()\u00a0-\u00a0no\u00a0validation\u00a0of\u00a0close\u00a0code\u00a0range\u00a0(should\u00a0be\u00a01000-4999)\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01174,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Error\u00a0handling\u00a0vulnerability\u00a0in\u00a0receiverOnError()\u00a0-\u00a0error\u00a0codes\u00a0are\u00a0not\u00a0properly\u00a0sanitized\u00a0before\u00a0being\u00a0used\u00a0in\u00a0close()\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket-server.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0234,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0validation\u00a0in\u00a0handleUpgrade()\u00a0-\u00a0Sec-WebSocket-Key\u00a0header\u00a0is\u00a0validated\u00a0but\u00a0not\u00a0properly\u00a0sanitized\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket-server.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0359,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Race\u00a0condition\u00a0in\u00a0completeUpgrade()\u00a0-\u00a0socket\u00a0may\u00a0be\u00a0destroyed\u00a0between\u00a0validation\u00a0and\u00a0upgrade\u00a0completion\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/event-target.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0189,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Memory\u00a0leak\u00a0in\u00a0addEventListener()\u00a0-\u00a0event\u00a0listeners\u00a0are\u00a0not\u00a0properly\u00a0cleaned\u00a0up\u00a0when\u00a0socket\u00a0is\u00a0closed\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01302,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Backpressure\u00a0handling\u00a0issue\u00a0in\u00a0socketOnData()\u00a0-\u00a0if\u00a0write\u00a0fails,\u00a0socket\u00a0is\u00a0paused\u00a0but\u00a0may\u00a0never\u00a0be\u00a0resumed\u00a0if\u00a0receiver\u00a0drains\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/websocket.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01326,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Error\u00a0handling\u00a0vulnerability\u00a0in\u00a0socketOnError()\u00a0-\u00a0error\u00a0events\u00a0are\u00a0suppressed\u00a0after\u00a0first\u00a0error\"\n\u00a0\u00a0}\n]",
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/autobahn-server.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a07,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"No\u00a0error\u00a0handling\u00a0for\u00a0port\u00a0parsing\u00a0-\u00a0could\u00a0lead\u00a0to\u00a0NaN\u00a0port\u00a0if\u00a0invalid\u00a0argument\u00a0provided\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/autobahn-server.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a010,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"No\u00a0rate\u00a0limiting\u00a0on\u00a0message\u00a0handling\u00a0-\u00a0could\u00a0lead\u00a0to\u00a0DoS\u00a0attacks\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/autobahn.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a05,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Global\u00a0variables\u00a0'currentTest'\u00a0and\u00a0'testCount'\u00a0could\u00a0cause\u00a0state\u00a0leakage\u00a0between\u00a0tests\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/autobahn.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a020,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"No\u00a0error\u00a0handling\u00a0for\u00a0WebSocket\u00a0connection\u00a0failures\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/websocket.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0611,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0security\u00a0issue\u00a0in\u00a0protocol\u00a0validation\u00a0-\u00a0allows\u00a0http/https\u00a0schemes\u00a0which\u00a0could\u00a0be\u00a0used\u00a0for\u00a0protocol\u00a0downgrade\u00a0attacks\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/websocket-server.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01254,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Protocol\u00a0handler\u00a0doesn't\u00a0validate\u00a0protocol\u00a0list\u00a0length\u00a0-\u00a0could\u00a0lead\u00a0to\u00a0memory\u00a0exhaustion\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"UTF-8\u00a0validation\u00a0tests\u00a0don't\u00a0cover\u00a0all\u00a0edge\u00a0cases\u00a0of\u00a0invalid\u00a0UTF-8\u00a0sequences\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/extension.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Extension\u00a0parsing\u00a0doesn't\u00a0properly\u00a0handle\u00a0malformed\u00a0input\u00a0that\u00a0could\u00a0cause\u00a0memory\u00a0issues\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/extension.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0191,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Extension\u00a0formatting\u00a0doesn't\u00a0properly\u00a0escape\u00a0special\u00a0characters\u00a0in\u00a0parameters\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-01 13:48:10"
}