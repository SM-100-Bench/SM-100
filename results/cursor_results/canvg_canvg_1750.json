{
  "url": "https://github.com/canvg/canvg/pull/1750",
  "identifier": "canvg_canvg_1750",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/SVGFontLoader.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a017,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability:\u00a0Loading\u00a0fonts\u00a0from\u00a0URLs\u00a0without\u00a0validation.\u00a0No\u00a0URL\u00a0sanitization\u00a0or\u00a0origin\u00a0checks\u00a0are\u00a0performed\u00a0before\u00a0loading\u00a0external\u00a0font\u00a0resources.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/SVGFontLoader.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a022,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0XSS\u00a0vulnerability:\u00a0Creating\u00a0elements\u00a0directly\u00a0from\u00a0loaded\u00a0SVG\u00a0font\u00a0nodes\u00a0without\u00a0sanitization.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Screen.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0286,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Memory\u00a0leak\u00a0potential:\u00a0The\u00a0animation\u00a0loop\u00a0in\u00a0start()\u00a0method\u00a0doesn't\u00a0properly\u00a0clean\u00a0up\u00a0requestAnimationFrame\u00a0when\u00a0component\u00a0is\u00a0unmounted\u00a0or\u00a0stop()\u00a0is\u00a0not\u00a0called.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Mouse.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a082,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Event\u00a0listener\u00a0memory\u00a0leak:\u00a0Mouse\u00a0event\u00a0listeners\u00a0are\u00a0not\u00a0properly\u00a0removed\u00a0if\u00a0the\u00a0component\u00a0is\u00a0destroyed\u00a0while\u00a0working=true.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/PathParser.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a041,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Regex\u00a0security\u00a0vulnerability:\u00a0The\u00a0regex\u00a0pattern\u00a0replacement\u00a0could\u00a0be\u00a0exploited\u00a0with\u00a0carefully\u00a0crafted\u00a0input\u00a0to\u00a0cause\u00a0catastrophic\u00a0backtracking.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Property.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a073,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Type\u00a0coercion\u00a0bug:\u00a0getNumber()\u00a0method\u00a0doesn't\u00a0properly\u00a0handle\u00a0non-numeric\u00a0strings\u00a0that\u00a0could\u00a0be\u00a0passed\u00a0as\u00a0values,\u00a0potentially\u00a0causing\u00a0NaN\u00a0propagation.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/BoundingBox.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a027,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Precision\u00a0loss\u00a0bug:\u00a0addPoint()\u00a0method\u00a0doesn't\u00a0handle\u00a0edge\u00a0cases\u00a0where\u00a0x\u00a0or\u00a0y\u00a0are\u00a0very\u00a0large\u00a0numbers\u00a0(close\u00a0to\u00a0Number.MAX_VALUE)\u00a0which\u00a0could\u00a0lead\u00a0to\u00a0incorrect\u00a0bounds\u00a0calculations.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Font.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a04,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0issue:\u00a0wrapFontFamily()\u00a0function\u00a0doesn't\u00a0properly\u00a0escape\u00a0quotes\u00a0in\u00a0font\u00a0family\u00a0names,\u00a0potentially\u00a0allowing\u00a0CSS\u00a0injection.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Canvg.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a031,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Resource\u00a0leak:\u00a0The\u00a0from()\u00a0static\u00a0method\u00a0doesn't\u00a0handle\u00a0cleanup\u00a0of\u00a0parser\u00a0resources\u00a0if\u00a0an\u00a0error\u00a0occurs\u00a0during\u00a0SVG\u00a0parsing.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Mouse.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0144,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability:\u00a0mapXY()\u00a0method\u00a0is\u00a0vulnerable\u00a0to\u00a0prototype\u00a0pollution\u00a0through\u00a0offsetParent\u00a0chain\u00a0traversal.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Screen.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0406,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Performance\u00a0issue:\u00a0render()\u00a0method\u00a0doesn't\u00a0implement\u00a0any\u00a0form\u00a0of\u00a0render\u00a0batching\u00a0or\u00a0throttling,\u00a0potentially\u00a0causing\u00a0performance\u00a0issues\u00a0with\u00a0rapid\u00a0updates.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Property.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0285,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Type\u00a0safety\u00a0issue:\u00a0getDefinition<T>()\u00a0method\u00a0doesn't\u00a0validate\u00a0that\u00a0the\u00a0returned\u00a0element\u00a0actually\u00a0matches\u00a0type\u00a0T,\u00a0potentially\u00a0causing\u00a0runtime\u00a0errors.\"\n\u00a0\u00a0}\n]",
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/ImageElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a063,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0XSS\u00a0vulnerability\u00a0in\u00a0loadSvg()\u00a0-\u00a0SVG\u00a0content\u00a0from\u00a0data\u00a0URIs\u00a0is\u00a0not\u00a0sanitized\u00a0before\u00a0being\u00a0rendered,\u00a0allowing\u00a0potential\u00a0script\u00a0injection\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/ImageElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a071,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Base64\u00a0decoding\u00a0with\u00a0atob()\u00a0is\u00a0not\u00a0wrapped\u00a0in\u00a0try-catch,\u00a0could\u00a0throw\u00a0for\u00a0malformed\u00a0input\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/ImageElement.ts\",\u00a0\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0127,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Race\u00a0condition\u00a0in\u00a0render()\u00a0-\u00a0loaded\u00a0flag\u00a0is\u00a0checked\u00a0but\u00a0image\u00a0loading\u00a0is\u00a0async,\u00a0could\u00a0lead\u00a0to\u00a0undefined\u00a0behavior\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/Element.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a066,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0duplicate\u00a0ID\u00a0collision\u00a0in\u00a0definitions\u00a0map\u00a0is\u00a0silently\u00a0ignored,\u00a0could\u00a0cause\u00a0rendering\u00a0issues\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/GElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a012,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Type\u00a0assertion\u00a0of\u00a0children\u00a0to\u00a0PathElement\u00a0is\u00a0unsafe,\u00a0could\u00a0crash\u00a0if\u00a0child\u00a0is\u00a0not\u00a0actually\u00a0a\u00a0PathElement\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/UseElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a089,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Memory\u00a0leak\u00a0potential\u00a0in\u00a0renderChildren()\u00a0-\u00a0tempSvg's\u00a0parent\u00a0reference\u00a0is\u00a0modified\u00a0but\u00a0not\u00a0properly\u00a0cleaned\u00a0up\u00a0if\u00a0render\u00a0throws\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/SVGElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0104,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Unsafe\u00a0type\u00a0assertion\u00a0of\u00a0refX/refY\u00a0values\u00a0to\u00a0number\u00a0without\u00a0validation,\u00a0could\u00a0cause\u00a0NaN\u00a0in\u00a0calculations\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/FontElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a054,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0prototype\u00a0pollution\u00a0in\u00a0arabicGlyphs\u00a0object\u00a0construction\u00a0using\u00a0direct\u00a0property\u00a0assignment\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/MarkerElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a021,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"No\u00a0validation\u00a0of\u00a0angle\u00a0parameter\u00a0in\u00a0render(),\u00a0could\u00a0cause\u00a0invalid\u00a0transformations\u00a0with\u00a0NaN/Infinity\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"src/Document/AElement.ts\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a069,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Improper\u00a0cleanup\u00a0of\u00a0temporary\u00a0GElement\u00a0-\u00a0parent\u00a0reference\u00a0remains\u00a0after\u00a0render\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-01 14:12:50"
}