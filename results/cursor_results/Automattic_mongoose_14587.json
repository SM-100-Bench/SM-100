{
  "url": "https://github.com/Automattic/mongoose/pull/14587",
  "identifier": "Automattic_mongoose_14587",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/browserDocument.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a020,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0prototype\u00a0pollution\u00a0vulnerability\u00a0in\u00a0Document\u00a0constructor\u00a0-\u00a0schema\u00a0parameter\u00a0is\u00a0not\u00a0properly\u00a0validated\u00a0before\u00a0being\u00a0used\u00a0to\u00a0create\u00a0a\u00a0new\u00a0Schema\u00a0instance\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/browserDocument.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a035,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Race\u00a0condition\u00a0in\u00a0Document\u00a0constructor\u00a0-\u00a0obj._id\u00a0assignment\u00a0is\u00a0not\u00a0atomic\u00a0and\u00a0could\u00a0lead\u00a0to\u00a0duplicate\u00a0IDs\u00a0in\u00a0concurrent\u00a0scenarios\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/document.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01022,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0memory\u00a0leak\u00a0in\u00a0$set\u00a0method\u00a0-\u00a0no\u00a0cleanup\u00a0of\u00a0old\u00a0values\u00a0when\u00a0setting\u00a0new\u00a0ones,\u00a0could\u00a0lead\u00a0to\u00a0memory\u00a0growth\u00a0over\u00a0time\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/document.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a02580,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Validation\u00a0error\u00a0handling\u00a0vulnerability\u00a0-\u00a0validate()\u00a0method\u00a0doesn't\u00a0properly\u00a0handle\u00a0async\u00a0validation\u00a0errors\u00a0in\u00a0all\u00a0cases\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/document.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a04511,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0DoS\u00a0vulnerability\u00a0in\u00a0populate()\u00a0method\u00a0-\u00a0no\u00a0limit\u00a0on\u00a0recursion\u00a0depth\u00a0when\u00a0populating\u00a0nested\u00a0documents\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/documentProvider.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a08,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Global\u00a0state\u00a0vulnerability\u00a0-\u00a0isBrowser\u00a0flag\u00a0is\u00a0mutable\u00a0and\u00a0could\u00a0be\u00a0changed\u00a0by\u00a0any\u00a0module\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/model.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0545,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Race\u00a0condition\u00a0in\u00a0save()\u00a0method\u00a0-\u00a0version\u00a0checking\u00a0and\u00a0saving\u00a0operations\u00a0are\u00a0not\u00a0atomic\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/model.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01166,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0DoS\u00a0vulnerability\u00a0in\u00a0exists()\u00a0method\u00a0-\u00a0no\u00a0limit\u00a0on\u00a0query\u00a0complexity\u00a0or\u00a0timeout\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/model.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a03110,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Memory\u00a0leak\u00a0in\u00a0insertMany()\u00a0-\u00a0no\u00a0cleanup\u00a0of\u00a0temporary\u00a0objects\u00a0created\u00a0during\u00a0bulk\u00a0insert\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/model.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a03504,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0race\u00a0condition\u00a0in\u00a0bulkWrite()\u00a0-\u00a0operations\u00a0are\u00a0not\u00a0properly\u00a0ordered\u00a0and\u00a0could\u00a0lead\u00a0to\u00a0inconsistent\u00a0state\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/model.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a04211,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Validation\u00a0error\u00a0handling\u00a0vulnerability\u00a0-\u00a0validate()\u00a0method\u00a0doesn't\u00a0properly\u00a0handle\u00a0all\u00a0error\u00a0cases\u00a0in\u00a0async\u00a0validation\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/model.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a04373,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0memory\u00a0leak\u00a0in\u00a0populate()\u00a0-\u00a0no\u00a0cleanup\u00a0of\u00a0temporary\u00a0objects\u00a0created\u00a0during\u00a0population\"\n\u00a0\u00a0}\n]",
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/aggregate.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01231,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0memory\u00a0leak\u00a0in\u00a0stream\u00a0handling\u00a0-\u00a0write\u00a0function\u00a0does\u00a0not\u00a0properly\u00a0handle\u00a0backpressure\u00a0or\u00a0error\u00a0cases\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/bigint.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a045,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0error\u00a0handling\u00a0for\u00a0BigInt\u00a0casting\u00a0-\u00a0test\u00a0does\u00a0not\u00a0verify\u00a0behavior\u00a0with\u00a0invalid\u00a0numeric\u00a0strings\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/browser.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a015,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Unsafe\u00a0exec()\u00a0usage\u00a0without\u00a0proper\u00a0error\u00a0handling\u00a0or\u00a0sanitization\u00a0of\u00a0input\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/errors.validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Missing\u00a0'use\u00a0strict'\u00a0directive\u00a0at\u00a0the\u00a0beginning\u00a0of\u00a0the\u00a0file\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/errors.validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0230,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0race\u00a0condition\u00a0in\u00a0async\u00a0validation\u00a0tests\u00a0-\u00a0no\u00a0proper\u00a0cleanup\u00a0between\u00a0test\u00a0cases\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/errors.validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0250,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0error\u00a0handling\u00a0in\u00a0child\u00a0process\u00a0test\u00a0-\u00a0stderr\u00a0filtering\u00a0may\u00a0miss\u00a0important\u00a0error\u00a0messages\"\n\u00a0\u00a0}\n]",
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/aggregate.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01231,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0memory\u00a0leak\u00a0in\u00a0stream\u00a0handling\u00a0-\u00a0write\u00a0function\u00a0does\u00a0not\u00a0properly\u00a0handle\u00a0backpressure\u00a0or\u00a0error\u00a0cases\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/bigint.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a045,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0error\u00a0handling\u00a0for\u00a0BigInt\u00a0casting\u00a0-\u00a0test\u00a0does\u00a0not\u00a0verify\u00a0behavior\u00a0with\u00a0invalid\u00a0numeric\u00a0strings\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/browser.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a015,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Unsafe\u00a0exec()\u00a0usage\u00a0without\u00a0proper\u00a0error\u00a0handling\u00a0or\u00a0sanitization\u00a0of\u00a0input\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/errors.validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Missing\u00a0'use\u00a0strict'\u00a0directive\u00a0at\u00a0the\u00a0beginning\u00a0of\u00a0the\u00a0file\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/errors.validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0230,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0race\u00a0condition\u00a0in\u00a0async\u00a0validation\u00a0tests\u00a0-\u00a0no\u00a0proper\u00a0cleanup\u00a0between\u00a0test\u00a0cases\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/errors.validation.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0250,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0error\u00a0handling\u00a0in\u00a0child\u00a0process\u00a0test\u00a0-\u00a0stderr\u00a0filtering\u00a0may\u00a0miss\u00a0important\u00a0error\u00a0messages\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/model.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a07286,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0prototype\u00a0pollution\u00a0vulnerability\u00a0in\u00a0class\u00a0extension\u00a0-\u00a0no\u00a0validation\u00a0of\u00a0inherited\u00a0properties\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/model.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a07500,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Unsafe\u00a0delay\u00a0function\u00a0implementation\u00a0-\u00a0no\u00a0maximum\u00a0timeout\u00a0limit\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/schema.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a01899,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0type\u00a0checking\u00a0in\u00a0custom\u00a0schema\u00a0type\u00a0implementation\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/schema.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a02966,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Unsafe\u00a0string\u00a0manipulation\u00a0in\u00a0getter/setter\u00a0functions\u00a0-\u00a0no\u00a0input\u00a0validation\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"test/schema.test.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a02882,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0error\u00a0handling\u00a0in\u00a0base\u00a0class\u00a0implementation\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-01 14:14:37"
}