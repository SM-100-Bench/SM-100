{
  "url": "https://github.com/django/django/pull/16642",
  "identifier": "django_django_16642",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/apps/registry.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a045,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0race\u00a0condition\u00a0in\u00a0Apps.__init__\u00a0when\u00a0checking\u00a0for\u00a0existing\u00a0registry.\u00a0The\u00a0check\u00a0for\u00a0hasattr(sys.modules[__name__],\u00a0'apps')\u00a0is\u00a0not\u00a0thread-safe\u00a0and\u00a0could\u00a0lead\u00a0to\u00a0multiple\u00a0registry\u00a0instances\u00a0being\u00a0created.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/apps/registry.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0100,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0Apps.populate(),\u00a0the\u00a0loading\u00a0flag\u00a0is\u00a0set\u00a0to\u00a0True\u00a0but\u00a0there's\u00a0no\u00a0try/finally\u00a0block\u00a0to\u00a0ensure\u00a0it's\u00a0reset\u00a0to\u00a0False\u00a0if\u00a0an\u00a0exception\u00a0occurs.\u00a0This\u00a0could\u00a0leave\u00a0the\u00a0registry\u00a0in\u00a0an\u00a0inconsistent\u00a0state.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/core/handlers/base.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a045,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0BaseHandler.load_middleware(),\u00a0the\u00a0middleware\u00a0chain\u00a0is\u00a0built\u00a0but\u00a0there's\u00a0no\u00a0validation\u00a0that\u00a0the\u00a0final\u00a0handler\u00a0is\u00a0callable.\u00a0This\u00a0could\u00a0lead\u00a0to\u00a0runtime\u00a0errors\u00a0if\u00a0middleware\u00a0returns\u00a0an\u00a0invalid\u00a0handler.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/core/handlers/base.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0200,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0_get_response(),\u00a0the\u00a0response\u00a0object\u00a0is\u00a0not\u00a0checked\u00a0for\u00a0None\u00a0before\u00a0calling\u00a0render().\u00a0This\u00a0could\u00a0lead\u00a0to\u00a0AttributeError\u00a0if\u00a0a\u00a0middleware\u00a0returns\u00a0None\u00a0instead\u00a0of\u00a0a\u00a0response\u00a0object.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/middleware/security.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a030,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0SecurityMiddleware.process_request(),\u00a0the\u00a0path\u00a0check\u00a0for\u00a0SSL\u00a0redirect\u00a0uses\u00a0lstrip('/')\u00a0which\u00a0could\u00a0be\u00a0bypassed\u00a0by\u00a0using\u00a0multiple\u00a0forward\u00a0slashes.\u00a0This\u00a0could\u00a0allow\u00a0bypassing\u00a0SSL\u00a0redirects.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/middleware/csrf.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0200,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0CsrfViewMiddleware._get_secret(),\u00a0there's\u00a0a\u00a0potential\u00a0timing\u00a0attack\u00a0in\u00a0the\u00a0constant_time_compare()\u00a0call.\u00a0The\u00a0function\u00a0is\u00a0used\u00a0correctly,\u00a0but\u00a0the\u00a0surrounding\u00a0code\u00a0could\u00a0leak\u00a0timing\u00a0information\u00a0about\u00a0token\u00a0validation.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/middleware/csrf.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0270,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0CsrfViewMiddleware._origin_verified(),\u00a0the\u00a0origin\u00a0checking\u00a0logic\u00a0could\u00a0be\u00a0bypassed\u00a0by\u00a0using\u00a0a\u00a0malformed\u00a0Origin\u00a0header.\u00a0The\u00a0code\u00a0doesn't\u00a0properly\u00a0validate\u00a0the\u00a0Origin\u00a0header\u00a0format\u00a0before\u00a0processing.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/core/handlers/base.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0300,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0BaseHandler.resolve_request(),\u00a0there's\u00a0no\u00a0validation\u00a0of\u00a0the\u00a0callback\u00a0function's\u00a0signature\u00a0before\u00a0calling\u00a0it.\u00a0This\u00a0could\u00a0lead\u00a0to\u00a0TypeError\u00a0if\u00a0the\u00a0view\u00a0function's\u00a0signature\u00a0doesn't\u00a0match\u00a0the\u00a0expected\u00a0arguments.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/apps/registry.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0386,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0Apps.lazy_model_operation(),\u00a0the\u00a0pending\u00a0operations\u00a0are\u00a0stored\u00a0in\u00a0a\u00a0defaultdict\u00a0but\u00a0there's\u00a0no\u00a0cleanup\u00a0mechanism\u00a0for\u00a0operations\u00a0that\u00a0are\u00a0never\u00a0completed.\u00a0This\u00a0could\u00a0lead\u00a0to\u00a0memory\u00a0leaks.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"django/middleware/security.py\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"line\":\u00a050,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0SecurityMiddleware.process_response(),\u00a0the\u00a0HSTS\u00a0header\u00a0is\u00a0only\u00a0added\u00a0for\u00a0secure\u00a0requests,\u00a0but\u00a0there's\u00a0no\u00a0validation\u00a0that\u00a0the\u00a0header\u00a0value\u00a0is\u00a0properly\u00a0formatted.\u00a0This\u00a0could\u00a0lead\u00a0to\u00a0security\u00a0header\u00a0injection.\"\n\u00a0\u00a0\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-01 13:31:02"
}