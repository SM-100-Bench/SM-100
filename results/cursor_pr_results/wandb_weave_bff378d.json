{
  "url": "https://github.com/wandb/weave/pull/1657",
  "identifier": "wandb_weave_bff378d",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"weave/weave_server.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0196,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Path\u00a0traversal\u00a0vulnerability\u00a0in\u00a0send_js\u00a0function\u00a0-\u00a0the\u00a0path\u00a0validation\u00a0is\u00a0insufficient\u00a0as\u00a0it\u00a0only\u00a0checks\u00a0if\u00a0the\u00a0local_artifacts_path\u00a0is\u00a0in\u00a0the\u00a0parents\u00a0list,\u00a0but\u00a0doesn't\u00a0prevent\u00a0accessing\u00a0files\u00a0outside\u00a0the\u00a0intended\u00a0directory\u00a0structure\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"weave/weave_server.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0196,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0security\u00a0issue\u00a0with\u00a0path\u00a0normalization\u00a0-\u00a0using\u00a0'/'\u00a0operator\u00a0with\u00a0pathlib.Path\u00a0could\u00a0lead\u00a0to\u00a0unexpected\u00a0path\u00a0resolution\u00a0on\u00a0different\u00a0operating\u00a0systems\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"weave/weave_server.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0196,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Missing\u00a0error\u00a0handling\u00a0for\u00a0pathlib.Path\u00a0operations\u00a0-\u00a0no\u00a0try/catch\u00a0block\u00a0around\u00a0path\u00a0operations\u00a0that\u00a0could\u00a0raise\u00a0exceptions\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"weave/weave_server.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0196,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Incomplete\u00a0path\u00a0validation\u00a0-\u00a0the\u00a0code\u00a0doesn't\u00a0check\u00a0if\u00a0the\u00a0path\u00a0contains\u00a0any\u00a0'..'\u00a0components\u00a0which\u00a0could\u00a0be\u00a0used\u00a0for\u00a0directory\u00a0traversal\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"weave/weave_server.py\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0196,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0race\u00a0condition\u00a0-\u00a0the\u00a0local_artifact_dir()\u00a0function\u00a0is\u00a0called\u00a0at\u00a0request\u00a0time\u00a0and\u00a0its\u00a0result\u00a0could\u00a0change\u00a0between\u00a0the\u00a0check\u00a0and\u00a0the\u00a0actual\u00a0file\u00a0access\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-26 18:59:25"
}