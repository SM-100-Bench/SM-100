{
  "url": "https://github.com/websockets/ws/pull/2231",
  "identifier": "websockets_ws_92d8696",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/WebSocketServer.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0153,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0null\u00a0reference\u00a0error\u00a0-\u00a0req.headers.upgrade\u00a0might\u00a0be\u00a0undefined\u00a0before\u00a0calling\u00a0toLowerCase()\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/WebSocketServer.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0153,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Logical\u00a0operator\u00a0precedence\u00a0issue\u00a0-\u00a0'version\u00a0!==\u00a08\u00a0&&\u00a0version\u00a0!==\u00a013'\u00a0should\u00a0be\u00a0grouped\u00a0with\u00a0parentheses\u00a0to\u00a0ensure\u00a0correct\u00a0evaluation\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/WebSocketServer.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0153,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Security\u00a0vulnerability\u00a0-\u00a0removed\u00a0check\u00a0for\u00a0req.headers.upgrade\u00a0existence\u00a0before\u00a0checking\u00a0its\u00a0value,\u00a0could\u00a0allow\u00a0non-WebSocket\u00a0connections\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"lib/WebSocketServer.js\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0153,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"Potential\u00a0race\u00a0condition\u00a0-\u00a0moved\u00a0shouldHandle\u00a0check\u00a0to\u00a0end\u00a0of\u00a0condition\u00a0chain,\u00a0could\u00a0allow\u00a0invalid\u00a0paths\u00a0to\u00a0be\u00a0processed\u00a0longer\u00a0than\u00a0necessary\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-26 15:06:27"
}