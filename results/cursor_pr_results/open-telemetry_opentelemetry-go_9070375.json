{
  "url": "https://github.com/open-telemetry/opentelemetry-go/pull/2285",
  "identifier": "open-telemetry_opentelemetry-go_9070375",
  "code_blocks": [
    "json\nApply\n[\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"api/standard/http.go\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a049,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0NetAttributesFromHTTPRequest,\u00a0if\u00a0request.RemoteAddr\u00a0contains\u00a0an\u00a0invalid\u00a0port\u00a0(non-numeric),\u00a0both\u00a0peerName\u00a0and\u00a0peerIP\u00a0are\u00a0set\u00a0to\u00a0empty\u00a0strings,\u00a0potentially\u00a0losing\u00a0valid\u00a0peer\u00a0information.\u00a0This\u00a0could\u00a0result\u00a0in\u00a0missing\u00a0attributes\u00a0for\u00a0valid\u00a0hostnames\u00a0or\u00a0IPs\u00a0with\u00a0a\u00a0malformed\u00a0port.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"api/standard/http.go\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a062,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0NetAttributesFromHTTPRequest,\u00a0the\u00a0code\u00a0parses\u00a0host\u00a0and\u00a0port\u00a0from\u00a0request.Host,\u00a0request.Header[\\\"Host\\\"],\u00a0and\u00a0request.URL.Host,\u00a0but\u00a0does\u00a0not\u00a0check\u00a0for\u00a0empty\u00a0strings\u00a0before\u00a0using\u00a0strings.LastIndex,\u00a0which\u00a0could\u00a0lead\u00a0to\u00a0unexpected\u00a0behavior\u00a0if\u00a0any\u00a0are\u00a0empty.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"api/standard/http.go\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a062,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"In\u00a0NetAttributesFromHTTPRequest,\u00a0the\u00a0code\u00a0only\u00a0considers\u00a0the\u00a0first\u00a0non-empty\u00a0hostPart\u00a0and\u00a0breaks,\u00a0potentially\u00a0missing\u00a0a\u00a0valid\u00a0host\u00a0in\u00a0later\u00a0fields\u00a0if\u00a0an\u00a0earlier\u00a0one\u00a0is\u00a0malformed\u00a0or\u00a0empty.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"api/standard/http.go\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a090,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"EndUserAttributesFromHTTPRequest\u00a0returns\u00a0the\u00a0username\u00a0from\u00a0BasicAuth\u00a0without\u00a0any\u00a0sanitization\u00a0or\u00a0validation.\u00a0If\u00a0the\u00a0username\u00a0is\u00a0attacker-controlled,\u00a0this\u00a0could\u00a0be\u00a0used\u00a0for\u00a0injection\u00a0attacks\u00a0if\u00a0not\u00a0handled\u00a0safely\u00a0downstream.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"api/standard/http.go\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0109,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"HTTPServerAttributesFromHTTPRequest\u00a0uses\u00a0request.Header[\\\"X-Forwarded-For\\\"][0]\u00a0directly\u00a0as\u00a0the\u00a0client\u00a0IP,\u00a0but\u00a0this\u00a0header\u00a0can\u00a0be\u00a0spoofed\u00a0by\u00a0clients.\u00a0This\u00a0could\u00a0lead\u00a0to\u00a0incorrect\u00a0attribution\u00a0or\u00a0security\u00a0issues\u00a0if\u00a0trusted\u00a0blindly.\"\n\u00a0\u00a0},\n\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\"file\":\u00a0\"api/standard/http.go\",\n\u00a0\u00a0\u00a0\u00a0\"line\":\u00a0226,\n\u00a0\u00a0\u00a0\u00a0\"description\":\u00a0\"SpanStatusFromHTTPStatusCode\u00a0uses\u00a0a\u00a0custom\u00a0validRangesPerCategory\u00a0map\u00a0for\u00a0HTTP\u00a0status\u00a0codes.\u00a0If\u00a0the\u00a0map\u00a0is\u00a0not\u00a0kept\u00a0in\u00a0sync\u00a0with\u00a0the\u00a0http\u00a0package,\u00a0it\u00a0could\u00a0misclassify\u00a0status\u00a0codes,\u00a0leading\u00a0to\u00a0incorrect\u00a0span\u00a0status\u00a0reporting.\"\n\u00a0\u00a0}\n]"
  ],
  "timestamp": "2025-05-26 16:01:41"
}