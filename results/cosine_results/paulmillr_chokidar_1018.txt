{ "issues": [ { "file": "lib/nodefs-handler.js", "line": 189, "description": "In setFsWatchListener, when creating a new FsWatchContainer ('cont'), 'listeners', 'errHandlers', and 'rawEmitters' are stored as a single function instead of a Set. This leads to inconsistent types for these properties, causing runtime errors when 'foreach' or '.forEach' is called expecting a Set." }, { "file": "lib/nodefs-handler.js", "line": 291, "description": "In setFsWatchFileListener, 'listeners' and 'rawEmitters' are sometimes initialized as a Set, sometimes as a single function. Later code expects these to be Sets, which can cause runtime errors (e.g., missing .forEach method)." }, { "file": "lib/nodefs-handler.js", "line": 273, "description": "In setFsWatchListener and setFsWatchFileListener, the closer function may call 'cont.watcher.close()' even if 'cont.watcher' is already undefined (after previous closure), leading to a possible exception." }, { "file": "index.js", "line": 333, "description": "In FSWatcher.close(), if close() is called multiple times before the first promise resolves, the second call may return undefined instead of a promise, which can lead to unhandled promise rejections or type errors." } ] }