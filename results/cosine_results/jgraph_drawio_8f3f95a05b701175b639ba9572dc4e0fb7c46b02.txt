{ "issues": [ { "file": "src/main/webapp/js/diagramly/LocalFile.js", "line": 56, "description": "Duplicate method definition: LocalFile.prototype.saveAs is defined twice. This will overwrite the first definition, which may be unintentional and could cause incorrect behavior if the two versions have different logic." }, { "file": "src/main/webapp/js/diagramly/LocalFile.js", "line": 116, "description": "Potential race condition: The saveFile method calls fileHandle.createWritable() and fileHandle.getFile() in parallel chains without locking. If the file is modified externally between these calls, lastModified comparison may not be reliable, leading to silent data loss or conflict." }, { "file": "src/main/webapp/js/diagramly/LocalFile.js", "line": 116, "description": "Error handling in saveFile: If this.desc is undefined (e.g., first save or after rename), accessing this.desc.lastModified will cause a TypeError and break the save process." }, { "file": "src/main/webapp/js/diagramly/Init.js", "line": 1, "description": "Inconsistent global variable checks: window.mxBasePath is checked for typeof 'undefined', but other globals use '||'. Potential for reference error if mxBasePath is not declared." }, { "file": "src/main/webapp/js/diagramly/Init.js", "line": 1, "description": "Potential information leak: GitHub/GitLab/Dropbox client IDs are hardcoded in the JS, which may expose them to the client and facilitate abuse of OAuth APIs." }, { "file": "src/main/webapp/index.html", "line": 1, "description": "Potential XSS risk: The mxscript, mxmeta, and mxinclude functions add script and meta elements to the DOM without sanitizing the src or content arguments. If urlParams are ever attacker-controlled, this could result in script injection." }, { "file": "src/main/webapp/js/diagramly/Settings.js", "line": 1, "description": "No validation or quota checks when writing to localStorage in mxSettings.save(). If the user disables cookies or fills the quota, this will silently fail and may result in data loss or missing settings." }, { "file": "src/main/webapp/js/diagramly/Settings.js", "line": 1, "description": "In mxSettings.parse, if the stored configVersion does not match Editor.configVersion, all user settings are reset without user warning, which could cause confusion or perceived data loss." } ] }