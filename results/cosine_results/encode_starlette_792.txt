{ "issues": [ { "file": "starlette/formparsers.py", "line": 128, "description": "No error handling when accessing headers['Content-Type'] directly; KeyError will be raised if header is missing. Should use headers.get('Content-Type') with a fallback or raise a more descriptive error." }, { "file": "starlette/formparsers.py", "line": 130, "description": "No check for missing multipart boundary parameter. If boundary is missing from Content-Type, passing None to MultipartParser will likely cause an exception or undefined behavior." }, { "file": "starlette/formparsers.py", "line": 130, "description": "No validation of parse_options_header output: if Content-Type is malformed, parse_options_header may return unexpected types or None, leading to exceptions downstream." }, { "file": "starlette/formparsers.py", "line": 189, "description": "When handling file uploads, UploadFile is initialized but file is not always closed in error cases, which could lead to resource leaks." }, { "file": "starlette/requests.py", "line": 140, "description": "Directly accesses self.scope['method'] without checking existence; could raise KeyError if scope is malformed." }, { "file": "starlette/requests.py", "line": 188, "description": "In Request.form(), no check if content_type_header is None before passing to parse_options_header; this could cause a TypeError." }, { "file": "starlette/requests.py", "line": 188, "description": "No error handling for parse_options_header output; if Content-Type is malformed, subsequent code could raise exceptions (e.g., when comparing content_type or accessing options)." }, { "file": "starlette/responses.py", "line": 179, "description": "RedirectResponse uses quote_plus for URLs, which is not appropriate for full URLs and may incorrectly encode safe characters, resulting in broken redirects." }, { "file": "starlette/responses.py", "line": 226, "description": "FileResponse does not sanitize the path parameter, which could allow for directory traversal attacks if untrusted user input is used." }, { "file": "starlette/responses.py", "line": 248, "description": "FileResponse assumes aio_stat and aiofiles.open will not raise exceptions other than FileNotFoundError, but permission errors, IO errors, or symlink attacks could cause unhandled exceptions or security vulnerabilities." } ] }