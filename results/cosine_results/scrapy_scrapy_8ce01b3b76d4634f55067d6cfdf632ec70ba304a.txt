{ "issues": [ { "file": "scrapy/downloadermiddlewares/decompression.py", "line": 29, "description": "Use of mktemp() is insecure due to possible race conditions. Use tempfile.NamedTemporaryFile or SpooledTemporaryFile instead." }, { "file": "scrapy/downloadermiddlewares/decompression.py", "line": 36, "description": "tarfile.extractfile(tar_file.members[0]) may raise IndexError if the TAR is empty, causing a crash." }, { "file": "scrapy/downloadermiddlewares/decompression.py", "line": 46, "description": "zipfile.BadZipfile was removed in Python 3. Use zipfile.BadZipFile. This will raise an AttributeError in Python 3, leading to unhandled exceptions." }, { "file": "scrapy/http/headers.py", "line": 29, "description": "Headers.getitem and get() return None if the header exists but the list is empty (IndexError). This may mask bugs where headers are expected to be present as a list." }, { "file": "scrapy/downloadermiddlewares/httpcompression.py", "line": 75, "description": "When decoding Content-Encoding, the code pops the last content encoding and removes the header if empty, but does not handle multiple encodings (e.g., gzip, then deflate)." }, { "file": "scrapy/downloadermiddlewares/httpcompression.py", "line": 95, "description": "The zstandard decompression uses reader.read() without proper streaming or error handling for very large or malformed frames, which may cause excessive memory usage or crashes." }, { "file": "scrapy/downloadermiddlewares/httpproxy.py", "line": 36, "description": "The _basic_auth_header function does not handle None passwords (could occur if only username is set in proxy URL), leading to a possible TypeError." }, { "file": "scrapy/http/request/form.py", "line": 217, "description": "In _get_inputs(), using k and v from _value(e) without checking if k is None may append (None, ...) to values, which can result in malformed form submissions." }, { "file": "scrapy/downloadermiddlewares/robotstxt.py", "line": 49, "description": "If the parser backend's from_crawler raises an exception, it is not caught and may crash the middleware initialization." } ] }