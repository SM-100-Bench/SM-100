{ "issues": [ { "file": "starlette/middleware/init.py", "line": 12, "description": "In repr, option_strings defined as string templates instead of interpolated values; should use an f-string or .format for actual key/value representation." }, { "file": "starlette/middleware/base.py", "line": 41, "description": "Uses asyncio.get_event_loop(), which may not be safe in all Python versions/environments (could fail in threads after Python 3.10)." }, { "file": "starlette/middleware/cors.py", "line": 147, "description": "Accesses request_headers[\"Origin\"] without checking existence; raises KeyError if Origin header is missing. Should use .get('Origin')." }, { "file": "starlette/middleware/gzip.py", "line": 68, "description": "Deletes 'Content-Length' header with del headers[\"Content-Length\"] without checking if it exists; MutableHeaders.delitem raises KeyError if header not present." }, { "file": "starlette/middleware/httpsredirect.py", "line": 13, "description": "url.hostname can be None if Host header is missing, which can cause netloc to be None and generate invalid URLs or raise exception." }, { "file": "starlette/middleware/sessions.py", "line": 43, "description": "json.loads(b64decode(data)) is not guarded; malformed session cookies could raise JSONDecodeError and crash request instead of treating as empty session." }, { "file": "starlette/middleware/wsgi.py", "line": 25, "description": "SERVER_PORT assigned as integer; WSGI expects it as a string. Should use str(server[1])." }, { "file": "starlette/middleware/wsgi.py", "line": 105, "description": "Header names and values are encoded as ASCII; WSGI spec allows only Latin-1. Non-ASCII headers could cause exceptions." } ] }