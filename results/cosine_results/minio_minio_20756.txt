{ "issues": [ { "file": "cmd/admin-bucket-handlers.go", "line": 402, "description": "Potential information disclosure: ExportBucketMetadataHandler returns error details over HTTP, including internal error messages, which could leak sensitive information." }, { "file": "cmd/admin-bucket-handlers.go", "line": 1064, "description": "ReplicationDiffHandler and ReplicationMRFHandler assume w implements http.Flusher without type checking. If this assumption is broken, it could panic at runtime." }, { "file": "cmd/admin-handlers-config-kv.go", "line": 276, "description": "SetConfigKVHandler writes configuration changes to disk before full validation (e.g., applying dynamic config after saving); improper validation could cause configuration corruption." }, { "file": "cmd/admin-handlers-config-kv.go", "line": 523, "description": "HelpConfigKVHandler writes directly to the HTTP response using json.NewEncoder(w).Encode(rd) without proper error handling or setting JSON headers, potentially leaking error details or causing malformed responses." }, { "file": "cmd/admin-handlers-idp-ldap.go", "line": 81, "description": "AttachDetachPolicyLDAP does not check for replay attacks or enforce strong content-type validation, which could allow request confusion. Also, only 'application/octet-stream' is accepted, potentially breaking some clients." }, { "file": "cmd/admin-handlers-idp-ldap.go", "line": 420, "description": "ListAccessKeysLDAPBulk: 'listType' parameter is not validated for empty string, which could cause unintended behavior or information disclosure." }, { "file": "cmd/admin-handlers-users.go", "line": 1081, "description": "AddUser: Accepts and stores decrypted user secrets from client input; if encryption is weak or secrets are mishandled upstream, this could be a security risk." }, { "file": "cmd/admin-handlers-users.go", "line": 2015, "description": "InfoCannedPolicy: Writes policy JSON directly to the HTTP response without setting content type or error checking, which could cause issues if the marshaling fails or if a client expects a specific content type." }, { "file": "cmd/admin-router.go", "line": 32, "description": "Gzip compression is applied to responses for most admin APIs. If an endpoint leaks secrets in the response, this could allow BREACH-style attacks. Consider limiting gzip on sensitive data." }, { "file": "cmd/admin-server-info.go", "line": 75, "description": "Sensitive environment variables are redacted by key name, but any variable containing 'password' or ending with 'key' (case-insensitive) is also redacted. However, secrets in other forms (e.g., tokens or credentials) may not be covered, potentially leaking secrets." } ] }