{ "issues": [ { "file": "sphinx/util/build_phase.py", "line": 15, "description": "Enum value 'CONSISTENCY_CHECK' and 'RESOLVING' are both assigned value 3 in BuildPhase, which will cause logic errors if both phases are expected to be distinct." }, { "file": "sphinx/util/png.py", "line": 17, "description": "In read_png_depth(), seeks and reads from the end of the file without checking the file size; malformed or very small files could cause an exception." }, { "file": "sphinx/util/png.py", "line": 28, "description": "In write_png_depth(), overwrites part of the PNG file with no validation of the file structure or size, which may corrupt files or cause exceptions/crashes if the file is not as expected." }, { "file": "sphinx/util/fileutil.py", "line": 41, "description": "Race condition: Destination file existence is checked and then opened without locking, which could result in TOCTOU (Time-of-check to time-of-use) errors." }, { "file": "sphinx/util/inventory.py", "line": 35, "description": "InventoryFileReader.readline() uses recursion for reading incomplete lines, which could cause a RecursionError on a very large or maliciously crafted file with no newlines." }, { "file": "sphinx/util/inventory.py", "line": 54, "description": "read_compressed_chunks does not handle decompression errors, which could result in uncaught exceptions or infinite loops on corrupt files." }, { "file": "sphinx/util/init.py", "line": 165, "description": "get_module_source() may return a string as filename and attempt to treat it as a path, which can result in TypeErrors if the loader returns the source as a string. Some error handling is present but not all cases are covered." }, { "file": "sphinx/util/init.py", "line": 530, "description": "encode_uri() encodes the path and query with quote_plus, which may encode slashes and break URIs unexpectedly." }, { "file": "sphinx/util/pycompat.py", "line": 67, "description": "execfile_() executes arbitrary files, which could be a security risk if called with untrusted input. The function itself is intended for internal use, but risk is present if misused." } ] }