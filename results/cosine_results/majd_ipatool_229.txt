{ "issues": [ { "file": "cmd/auth.go", "line": 55, "description": "Potential panic due to direct type assertion: cmd.Context().Value("interactive").(bool). If the context does not have 'interactive' key or value is not a bool, this will panic. Should use type assertion with 'ok' check." }, { "file": "cmd/auth.go", "line": 73, "description": "Password may contain trailing newlines if entered interactively, but unlike auth code, does not trim them. This could cause authentication failures if the password is entered with a newline." }, { "file": "cmd/common.go", "line": 63, "description": "Potential panic due to direct type assertion: cmd.Context().Value("interactive").(bool). If the context does not have 'interactive' key or value is not a bool, this will panic. Should use type assertion with 'ok' check." }, { "file": "cmd/common.go", "line": 83, "description": "util.Must is used to wrap newKeychain, newCookieJar, OutputFormatFromString, and createConfigDirectory. If any of these functions return an error, util.Must will panic, causing the app to exit abruptly. This is expected for some CLI tools but may not be user-friendly, especially for configuration directory creation or output format parsing." }, { "file": "cmd/root.go", "line": 57, "description": "If cmd.Execute() returns an error before dependencies are initialized, calling dependencies.Logger in the error handling path will panic due to nil dependencies. There is an attempt to check with reflect.ValueOf(dependencies).IsZero(), but this does not reliably check if fields are initialized (they are zero values, not nil pointers)." }, { "file": "cmd/download.go", "line": 61, "description": "If lastErr is not updated (e.g., first try), code paths relying on errors.Is(lastErr, ...) will never be true on first attempt, potentially skipping necessary re-authentication or purchase logic on first failure." }, { "file": "cmd/output_format.go", "line": 19, "description": "OutputFormatFromString returns OutputFormatJSON by default for unknown values, which may not be expected. This could mask user errors where an invalid output format is provided." }, { "file": "cmd/purchase.go", "line": 29, "description": "Same issue as download.go: lastErr is not meaningful on first attempt, so logic intended to handle retries (like re-authentication) may not trigger as intended." } ] }