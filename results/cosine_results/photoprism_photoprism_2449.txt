{ "issues": [ { "file": "cmd/photoprism/photoprism.go", "line": 107, "description": "Potential nil pointer dereference: if the returned error from photoprism.NewApp is not checked before using the app variable, it may cause a crash." }, { "file": "internal/photoprism/convert.go", "line": 244, "description": "Use of exec.Command with user-influenced input (external tool invocation): if user input is not strictly validated or sanitized, this could allow command injection." }, { "file": "internal/photoprism/import.go", "line": 88, "description": "Possible path traversal vulnerability: if input paths are not sanitized, an attacker could import or overwrite files outside the intended directory via crafted relative paths." }, { "file": "internal/photoprism/mediafile.go", "line": 325, "description": "Potential out-of-bounds access: if index or slice bounds are not checked before accessing elements in metadata parsing code, this may cause panics." }, { "file": "internal/photoprism/photos.go", "line": 501, "description": "Unchecked SQL error: executing a query without checking the returned error may hide critical database issues and lead to inconsistent state." }, { "file": "internal/photoprism/faces.go", "line": 213, "description": "Possible data race: concurrent access to shared in-memory face cache without synchronization could cause inconsistent results or panics." }, { "file": "internal/photoprism/convert_worker.go", "line": 78, "description": "Goroutine leak: launching a goroutine without a proper cancellation mechanism or error handling may lead to resource exhaustion." }, { "file": "internal/photoprism/config.go", "line": 142, "description": "Use of os.Getenv without fallback or validation may result in empty or malformed configuration values, causing undefined behavior." }, { "file": "internal/photoprism/colors.go", "line": 56, "description": "Possible division by zero in color normalization if input color values are not validated." }, { "file": "internal/photoprism/cleanup.go", "line": 98, "description": "Potentially deleting files based on user-supplied patterns without sufficient checks, leading to accidental or malicious data loss." } ] }