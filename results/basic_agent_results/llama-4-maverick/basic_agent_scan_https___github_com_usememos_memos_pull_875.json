{"repo_id": "usememos_memos_875", "bugs": [{"description": "Potential ReDoS vulnerability in LINK_REG regular expression", "file": "web/src/labs/marked/parser/Link.ts", "line": 8}], "updated_files": {"/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmplzyrb4h7/web/src/labs/marked/parser/Link.ts": "import { escape } from \"lodash-es\";\nimport Emphasis from \"./Emphasis\";\nimport Bold from \"./Bold\";\nimport { marked } from \"..\";\nimport InlineCode from \"./InlineCode\";\nimport BoldEmphasis from \"./BoldEmphasis\";\n\nexport const LINK_REG = /\\[(.*?)\\]\\((.+?)\\)/;\n\nconst matcher = (rawStr: string) => {\n  const matchResult = rawStr.match(LINK_REG);\n  return matchResult;\n};\n\nconst renderer = (rawStr: string): string => {\n  const matchResult = matcher(rawStr);\n  if (!matchResult) {\n    return rawStr;\n  }\n  const parsedContent = marked(escape(matchResult[1]), [], [InlineCode, BoldEmphasis, Emphasis, Bold]);\n  return `<a class='link' target='_blank' rel='noreferrer' href='${escape(matchResult[2])}'>${parsedContent}</a>`;\n};\n\nexport default {\n  name: \"link\",\n  regex: LINK_REG,\n  matcher,\n  renderer,\n};\n"}}