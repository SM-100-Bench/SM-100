{"repo_id": "hashicorp_go-slug_fbb041690f076f8e983a0f5f0d7406545a41359a", "bugs": [{"description": "Potential index out of bounds panic when accessing path[0] without checking if the string is empty. If header.Name is an empty string, this will cause a runtime panic.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/unpackinfo.go", "line": 36}, {"description": "Incorrect build tag 'linux_amd' is not a standard Go build constraint. This should likely be 'linux && 386' for 32-bit x86 Linux systems. The current tag will never match any actual build configuration.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/lchtimes_linux32.go", "line": 4}, {"description": "Path traversal vulnerability: The prefix check using strings.HasPrefix(target, dst) is insufficient to prevent directory traversal attacks. For example, if dst='/tmp/foo' and target='/tmp/foobar', the check passes but the target is outside the intended directory. The check should ensure target is within dst by verifying dst ends with a path separator or target has a path separator after the dst prefix.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/unpackinfo.go", "line": 43}, {"description": "Incomplete symlink detection: The IsSymlink() method only checks for tar.TypeSymlink but does not check for tar.TypeLink (hard links). While hard links are different from symbolic links, they can also be used in similar attacks and the code should handle both types consistently or explicitly document why hard links are excluded.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/unpackinfo.go", "line": 95}, {"description": "Inconsistent build tags: The build constraint references 'linux_amd' and 'linux_arm' which are not standard Go build tags, matching the same incorrect tags used in lchtimes_linux32.go. This creates a build configuration gap where some Linux systems may not match any of the platform-specific files.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/lchtimes_others.go", "line": 4}, {"description": "Inconsistent error handling: The restoreNormal() function does not check for os.IsNotExist(err) like restoreDirectory() does, which means it will return an error if the file was deleted between extraction and restoration. This inconsistency could cause unnecessary failures.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/unpackinfo.go", "line": 148}, {"description": "Missing support for hard links: The supported file type check (line 86) does not include tar.TypeLink (hard links), but hard links are a legitimate file type that should be supported. The IsSymlink() method only checks for symbolic links, not hard links, so hard links will be rejected as unsupported file types.", "file": "/var/folders/hp/rv5nbb3140l0404lfjq_pq140000gn/T/tmpoqzh46t7/internal/unpackinfo/unpackinfo.go", "line": 86}], "updated_files": {}}