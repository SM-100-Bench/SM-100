{"repo_id": "etesync_server_107", "bugs": [{"description": "Host header can be None but is passed to function expecting string. request.headers.get('Host') returns Optional[str] but validate_login_request expects a string parameter for host_from_request. This could cause a TypeError when the Host header is missing.", "file": "etebase_fastapi/routers/authentication.py", "line": 196}, {"description": "Same Host header issue as line 196. request.headers.get('Host') returns Optional[str] but validate_login_request expects a string parameter for host_from_request. This could cause a TypeError when the Host header is missing.", "file": "etebase_fastapi/routers/authentication.py", "line": 211}, {"description": "Incorrect chunk content extraction logic. The code checks 'len(chunk) > 1' but chunk is defined as ChunkType = t.Tuple[str, t.Optional[bytes]], so len(chunk) will always be 2. This means content will never be None even when chunk[1] is None, potentially causing issues when trying to create chunks without content.", "file": "etebase_fastapi/routers/collection.py", "line": 300}, {"description": "zip() will raise ValueError on empty list. If 'data' is an empty list, the list comprehension will produce an empty list, and zip(*[]) will raise 'ValueError: zip argument #1 must be a sequence'. This will cause the endpoint to crash when called with empty data.", "file": "etebase_fastapi/routers/collection.py", "line": 552}, {"description": "Variable name shadowing causes confusion. The parameter 'user' shadows the imported User model from line 9, making it impossible to reference the User model within this function scope. This could lead to bugs if the function needs to access the User model.", "file": "etebase_fastapi/routers/invitation.py", "line": 242}, {"description": "Incorrect Redis expiry time calculation. Redis expire parameter expects seconds, but the code multiplies TICKET_VALIDITY_SECONDS (10) by 1000, setting expiry to 10,000 seconds (2.78 hours) instead of the intended 10 seconds. This causes tickets to remain valid much longer than intended, which is a security issue.", "file": "etebase_fastapi/routers/websocket.py", "line": 54}, {"description": "Missing parentheses for method call. The code has 'queryset.filter(uid=ticket_model.req.collection).first' but 'first' is a method that needs to be called with parentheses. This will cause an AttributeError when the code tries to await a method object instead of calling it.", "file": "etebase_fastapi/routers/websocket.py", "line": 113}, {"description": "Missing collection parameter in invitation creation. The code excludes 'collection' from data.dict() but never passes the collection object to the create() call. This will cause an IntegrityError or missing required field error since CollectionInvitation requires a collection field.", "file": "etebase_fastapi/routers/invitation.py", "line": 209}], "updated_files": {}}