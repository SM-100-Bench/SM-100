{"repo_id": "minio_minio_20986", "bugs": [{"description": "Logic bug in filterAlgos function: the 'found' variable is not reset between iterations of the outer loop, causing incorrect validation behavior. If an algorithm is not found in the allowed list, 'found' remains true from a previous iteration, preventing the fatal error from being triggered for invalid algorithms.", "file": "cmd/sftp-server.go", "line": 375}, {"description": "Struct tag typo: 'mxl' should be 'xml' in the ProtocolCapabilities field. This will cause incorrect XML marshaling/unmarshaling behavior for the ProtocolCapabilities field in the systemInfo struct.", "file": "cmd/veeam-sos-api.go", "line": 102}, {"description": "Resource leak: Using context.Background() instead of the cancellable context 'cctx' in RemoveObjects call. This prevents proper cancellation and can lead to resource leaks when the parent context is cancelled.", "file": "cmd/ftp-server-driver.go", "line": 433}, {"description": "Resource leak: Using context.Background() instead of the cancellable context 'cctx' in RemoveObjects call. This prevents proper cancellation and can lead to resource leaks when the parent context is cancelled.", "file": "cmd/sftp-server-driver.go", "line": 347}, {"description": "Error masking: The function returns 'err' from the range loop variable instead of the actual removal error. This can mask real errors from the RemoveObjects operation since 'err' will be the last error from the range iteration, not necessarily the actual operation error.", "file": "cmd/ftp-server-driver.go", "line": 352}, {"description": "Error masking: The function returns 'err' from the range loop variable instead of the actual removal error. This can mask real errors from the RemoveObjects operation since 'err' will be the last error from the range iteration, not necessarily the actual operation error.", "file": "cmd/sftp-server-driver.go", "line": 352}, {"description": "String formatting vulnerability: User input is directly used in fmt.Sprintf format string without validation. The 'MinioStoreName', 'MinioLicense', and 'Version' variables could contain format specifiers that lead to unexpected behavior or information disclosure.", "file": "cmd/ftp-server.go", "line": 139}, {"description": "Missing error check: The error from updateObjectMetadataWithZipInfo call on line 153 is not checked before being used on line 155. This can lead to using uninitialized zipInfo data if the function fails.", "file": "cmd/s3-zip-handlers.go", "line": 153}, {"description": "Potential infinite loop and memory exhaustion: In getFilesListFromZIPObject, the size variable can grow indefinitely if zipindex.ReadDir keeps returning ErrNeedMoreData with increasing FromEnd values. The only protection is a 100MB limit, but there's no validation that the system has enough memory available.", "file": "cmd/s3-zip-handlers.go", "line": 354}, {"description": "Incorrect XML encoding: Double quotes are manually added around string values in XML fields (ProtocolVersion and ModelName). This will result in malformed XML with escaped quotes, as the XML encoder will automatically escape the quotes, leading to values like '\\\"1.0\\\"' instead of '1.0'.", "file": "cmd/veeam-sos-api.go", "line": 158}], "updated_files": {}}